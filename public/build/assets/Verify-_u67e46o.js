import{x as D,d as u,G as I,e as v,o as m,b,a as o,u as k,j as S,f as $,g as x,t as y,F as j,h as C,n as T,W as N,k as B,p as M}from"./app-BtxSZjW6.js";import{_ as P,a as K}from"./Footer-H0bPP_si.js";import{u as z}from"./useNotOnDutyApplicationStore-DSlZ1tEg.js";const F={class:"min-h-screen flex flex-col"},R={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-red-500 text-white p-4 rounded-lg shadow-lg w-[90%] max-w-md z-50"},U={class:"flex justify-between items-start"},W={class:"flex-grow flex flex-col items-center bg-background mt-4"},G={class:"max-w-md w-full"},L={class:"bg-white border border-gray-300 rounded-xl p-8"},q={class:"text-gray-500 text-sm mb-6"},H={class:"flex justify-center space-x-4 mb-6"},J=["onUpdate:modelValue","onInput","onKeydown"],Q={class:"flex justify-between text-sm text-gray-700"},te={__name:"Verify",setup(X){const a=z(),_=D({...a.$state,otp:"",number_of_persons:a.not_on_duty_details.length+a.family_details.length+1}),r=u(["","","",""]),g=()=>{_.otp=r.value.join("")},w=u([]),f=u([]),V=(e,t)=>{var l;const s=t.target.value;if(s.length>1){r.value=s.slice(0,4).split(""),g();return}s&&e<f.value.length-1&&((l=f.value[e+1])==null||l.focus()),g()},A=(e,t)=>{var s;t.key==="Backspace"&&(r.value[e]?(r.value[e]="",t.preventDefault()):e>0&&((s=f.value[e-1])==null||s.focus()),g())},d=u(!1),n=u(""),i=u(!0),p=u(120),h=()=>{p.value=120,i.value=!0;const e=setInterval(()=>{--p.value<=0&&(i.value=!1,clearInterval(e))},1e3)};I(()=>{f.value=w.value,h()});function E(){_.post(route("apply.not-on-duty.submit"),{onSuccess:()=>{a.reset()},onError:e=>{if(d.value=!0,e)if(typeof e=="string")n.value=e;else if(typeof e=="object"){const t=Object.values(e)[0];Array.isArray(t)?n.value=t[0]:n.value=t}else n.value="An unexpected error occurred."}})}function O(){N.get(route("apply.not-on-duty.verify"),{contact:a.contact,type:a.type},{preserveState:!0,replace:!0,onError:e=>{if(d.value=!0,e)if(typeof e=="string")n.value=e;else if(typeof e=="object"){const t=Object.values(e)[0];Array.isArray(t)?n.value=t[0]:n.value=t}else n.value="An unexpected error occurred."},onSuccess:e=>{h()}})}return(e,t)=>(m(),v(j,null,[b(k(S),{title:"Verify"}),o("div",F,[b(P),d.value?(m(),v("div",R,[o("div",U,[o("div",null,[t[3]||(t[3]=o("b",{class:"block"},"Please correct the following error(s):",-1)),x(" "+y(n.value),1)]),o("button",{onClick:t[0]||(t[0]=s=>d.value=!1),class:"ml-4 text-white font-bold text-xl leading-none"},"Ã—")])])):$("",!0),o("div",W,[o("div",G,[o("div",L,[t[5]||(t[5]=o("h2",{class:"text-gray-900 font-semibold text-xl mb-2"},"Enter OTP to verify",-1)),o("p",q,[x(" An OTP has been sent to "+y(k(a).contact)+" ",1),o("span",{onClick:t[1]||(t[1]=s=>e.$inertia.get(e.route("apply.not-on-duty.step-two"))),class:"text-green-600 cursor-pointer"},"(Edit)")]),o("div",H,[(m(!0),v(j,null,C(r.value,(s,l)=>B((m(),v("input",{key:l,"onUpdate:modelValue":c=>r.value[l]=c,type:"text",maxlength:"1",inputmode:"numeric",pattern:"[0-9]*",class:"w-12 h-12 border border-gray-300 rounded-lg text-center text-lg font-normal text-gray-900 focus:outline-none focus:ring-2 focus:ring-green-600",onInput:c=>V(l,c),ref_for:!0,ref_key:"otpInput",ref:w,onKeydown:c=>A(l,c)},null,40,J)),[[M,r.value[l]]])),128))]),o("div",Q,[o("p",null,[t[4]||(t[4]=x(" Did not get the OTP? ")),o("span",{class:T({"text-gray-400 cursor-not-allowed":i.value,"text-blue-600 cursor-pointer":!i.value}),onClick:t[2]||(t[2]=s=>!i.value&&O())}," Resend",2)]),o("p",null,y(Math.floor(p.value/60))+":"+y((p.value%60).toString().padStart(2,"0")),1)])]),o("button",{onClick:E,type:"submit",class:"mt-6 w-full bg-black text-white py-3 rounded-lg text-center text-base font-normal"}," Verify ")])]),b(K)])],64))}};export{te as default};
